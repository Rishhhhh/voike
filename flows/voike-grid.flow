FLOW "VOIKE Grid Fibonacci"

INPUTS
  text projectId
  number fibIndex
  number chunkSize optional
END INPUTS

STEP submit =
  APX_EXEC "grid.submitJob"
    WITH {
      "projectId": projectId,
      "jobType": "custom",
      "payload": {
        "task": "fib_split",
        "n": fibIndex,
        "chunkSize": chunkSize
      }
    }

STEP await =
  APX_EXEC "grid.awaitJob"
    WITH {
      "projectId": projectId,
      "jobId": submit.jobId
    }

STEP output =
  OUTPUT_TEXT {
    jobId = submit.jobId,
    fibIndex = fibIndex,
    result = await.result.fib,
    segments = await.result.segments,
    status = await.status,
    assignedNode = await.assignedNodeId
  }

END FLOW
